# Руководство по запуску

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка окружения

Создайте файл `.env` (скопируйте из `.env.example`):

```bash
cp .env.example .env
```

Заполните необходимые переменные (для начала можно оставить по умолчанию).

### 3. Запуск сервера

```bash
python main.py
```

Или через uvicorn:

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

Сервер запустится на `http://localhost:8000`

### 4. Проверка работы API

Откройте в браузере:
- `http://localhost:8000` - главная страница
- `http://localhost:8000/docs` - автоматическая документация Swagger
- `http://localhost:8000/redoc` - альтернативная документация ReDoc

### 5. Тестирование

#### Создать тестовое уведомление:

```bash
curl -X POST "http://localhost:8000/api/webhooks/airtable/test"
```

#### Получить список уведомлений:

```bash
curl "http://localhost:8000/api/notifications"
```

#### Получить статистику:

```bash
curl "http://localhost:8000/api/stats"
```

### 6. Тестирование фронтенда

1. Откройте `index.html` в браузере
2. Или запустите простой HTTP сервер:
   ```bash
   python -m http.server 3000
   ```
3. Откройте `http://localhost:3000`

**Важно:** В `app.js` убедитесь, что `API_BASE_URL` указывает на ваш FastAPI сервер.

---

## Рекомендуемый порядок разработки

### Этап 1: Локальная разработка (текущий этап)

1. ✅ Запустить FastAPI сервер локально
2. ✅ Тестировать API через Swagger UI (`/docs`)
3. ✅ Протестировать фронтенд с реальным API
4. ⏳ Добавить тестовые данные через API

### Этап 2: Развертывание

1. Развернуть FastAPI на хостинге (Railway, Render, Heroku)
2. Развернуть фронтенд на статическом хостинге (Vercel, Netlify)
3. Обновить `API_BASE_URL` в `app.js`

### Этап 3: Интеграция с Telegram

1. Создать бота через @BotFather
2. Настроить Mini App в BotFather
3. Протестировать открытие приложения через бота

### Этап 4: Интеграция с Airtable

1. Настроить webhook в Airtable
2. Указать URL вашего API: `https://your-domain.com/api/webhooks/airtable`
3. Протестировать получение событий

---

## Структура проекта

```
.
├── main.py              # Точка входа FastAPI
├── models.py            # Pydantic модели
├── database.py          # Модели БД и подключение
├── services.py          # Бизнес-логика
├── routers/             # API роутеры
│   ├── notifications.py
│   ├── webhooks.py
│   └── stats.py
├── index.html           # Фронтенд
├── styles.css
├── app.js
├── requirements.txt
└── README.md
```

---

## Часто встречающиеся проблемы

### Ошибка импорта модулей

Убедитесь, что все файлы на месте и структура папок правильная.

### База данных не создается

Проверьте права на запись в текущей директории. SQLite создаст файл `notifications.db` автоматически.

### CORS ошибки

Если видите ошибки CORS при работе с фронтендом, проверьте настройки в `main.py`.

### Порт занят

Если порт 8000 занят, измените в `main.py`:
```python
uvicorn.run("main:app", host="0.0.0.0", port=8001, reload=True)
```

---

## Следующие шаги

1. Протестировать API локально
2. Добавить больше тестовых данных
3. Настроить интеграцию с Airtable
4. Развернуть на хостинге
5. Подключить Telegram бота

